<dependency>
    <groupId>org.apache.poi</groupId>
    <artifactId>poi-ooxml</artifactId>
    <version>5.2.3</version>
</dependency>

===========

@DataProvider(name = "excelData")
public Object[][] getExcelData() throws IOException {
    List<Object[]> data = new ArrayList<>();
    FileInputStream fis = null;
    Workbook workbook = null;

    try {
        // Load the Excel file
        fis = new FileInputStream(new File("Data1.xlsx"));
        workbook = new XSSFWorkbook(fis); // Use XSSFWorkbook for .xlsx files

        // Access the first sheet
        Sheet sheet = workbook.getSheetAt(0);

        // Iterate over rows and collect data
        for (int i = 1; i <= sheet.getLastRowNum(); i++) { // Start from row 1 (row 0 is header)
            Row row = sheet.getRow(i);
            if (row != null) {
                String[] rowData = new String[row.getLastCellNum()];
                for (int j = 0; j < row.getLastCellNum(); j++) {
                    Cell cell = row.getCell(j);
                    rowData[j] = cell != null ? cell.toString().trim() : ""; // Handle null cells
                }
                data.add(rowData);
            }
        }
    } finally {
        if (fis != null) fis.close();
        if (workbook != null) workbook.close();
    }

    return data.toArray(new Object[0][]); // Convert list to 2D array
}
